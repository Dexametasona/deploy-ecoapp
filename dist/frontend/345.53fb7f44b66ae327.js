"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[345],{4345:(C,p,n)=>{n.r(p),n.d(p,{ProfileModule:()=>A});var f=n(6814),g=n(8589),s=n(95),d=n(9189),h=n(3519),c=n.n(h),e=n(6689),b=n(9626),x=n(3934),w=n(304),v=n(2213);function y(r,l){if(1&r&&(e.TgZ(0,"h1",16),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.UserResponse.nombre+" "+t.UserResponse.apellido," ")}}function Z(r,l){if(1&r&&(e.TgZ(0,"h2",35),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.UserResponse.email)}}function U(r,l){1&r&&(e.TgZ(0,"p",38),e._uU(1,"Cuenta verificada"),e.qZA())}function P(r,l){1&r&&(e.TgZ(0,"p",39),e._uU(1,"Debe Verificar su cuenta"),e.qZA())}function T(r,l){if(1&r&&(e.TgZ(0,"h2",35),e.YNc(1,U,2,0,"p",36),e.YNc(2,P,2,0,"p",37),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.UserResponse.validEmail),e.xp6(1),e.Q6J("ngIf",!t.UserResponse.validEmail)}}function E(r,l){if(1&r&&(e.TgZ(0,"h2",35),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.UserResponse.puntos+" EcoPuntos")}}function _(r,l){1&r&&(e.TgZ(0,"app-button",40),e._uU(1,"Verificar cuenta"),e.qZA())}const q=[{path:"",component:(()=>{class r{constructor(t,i,o,a,u){this.fb=t,this.validator=i,this.tokenService=o,this.userService=a,this.authService=u,this.UserResponse=null,this.showPassword=!1,this.showRepeatPassword=!1,this.selectedImage=null,this.imageUrl=null,this.form=this.fb.group({nombre:["",[s.kI.required,s.kI.minLength(2),s.kI.maxLength(60),d.AE]],apellido:["",[s.kI.required,s.kI.minLength(2),s.kI.maxLength(60),d.AE]],email:["",[s.kI.required,s.kI.minLength(8),s.kI.maxLength(255),d.Le]],password:["",[s.kI.required,s.kI.minLength(8),s.kI.maxLength(128),d.ym]],repeatPassword:["",s.kI.required]})}ngOnInit(){this.authService.userLogged$.subscribe(t=>this.UserResponse=t),this.updateImage()}updateImage(){const t=document.querySelector("#img-picker"),i=document.querySelector("#preview"),o=document.querySelector("#miImagen").addEventListener("click",function(){console.log("Clicando"),t.click()});console.log(o),t.addEventListener("change",function a(){console.log("update image");const u=t.files[0],m=new FileReader;m.onload=function(){i.setAttribute("src",m.result)},u&&m.readAsDataURL(u)})}showEdit(){var t=document.getElementById("edit");t?.classList.toggle("hidden")}uploadImage(t){const i=t.target.files[0];if(i){const o=new FormData;o.append("imagen",i),this.userService.PostImageUser(o).subscribe({next:a=>{console.log(a),c().fire({title:"Imagen actualizada!",text:"Tus imagen han sido actualizado  exitosamente",icon:"success"}).then(()=>{})},error(a){console.log("error con la imagen",a)}})}}onSubmit(){if(this.form.invalid||this.form.value.password!==this.form.value.repeatPassword)return this.form.markAllAsTouched();this.userService.updateUser(this.UserResponse.userId,this.form.value).subscribe({next:()=>{console.log(this.selectedImage),c().fire({title:"\xa1Datos guardados exitosamente!",text:"Tus datos han sido actualizado",icon:"success"}).then(()=>{window.location.reload()})},error:t=>{console.log(t),c().fire({title:"Ha ocurrido un error...",text:t.error,icon:"error"})}})}onFileSelected(t){this.selectedImage=t.target.files[0]}handleShowPassword(){this.showPassword=!this.showPassword}handleShowRepeatPassword(){this.showRepeatPassword=!this.showRepeatPassword}hasError(t,i){return this.validator.hasError(this.form,t,i)}get nameErrorMessage(){const t="nombre";return this.hasError(t,"required")?"El nombre es requerido":this.hasError(t,"minlength")||this.hasError(t,"maxlength")?"Debe tener entre 2 y 60 caracteres":this.hasError(t,"numericSpecialCharacter")?"No se admiten caracteres num\xe9ricos ni especiales":""}get lastNameErrorMessage(){const t="apellido";return this.hasError(t,"required")?"El apellido es requerido":this.hasError(t,"numericSpecialCharacter")?"No se admiten caracteres num\xe9ricos ni especiales":this.hasError(t,"minlength")||this.hasError(t,"maxlength")?"Debe tener entre 2 y 60 caracteres":""}get emailErrorMessage(){return this.hasError("email","required")?"El email es requerido":this.hasError("email","email")?"Ingresa un email v\xe1lido":this.hasError("email","minlength")||this.hasError("email","maxlength")?"Debe tener entre 8 y 255 caracteres":""}get passwordErrorMessage(){return this.hasError("password","required")?"La contrase\xf1a es requerida":this.hasError("password","minlength")||this.hasError("password","maxlength")?"Debe tener entre 8 y 128 caracteres":this.hasError("password","password")?"Debe contener al menos 1 min\xfascula, 1 may\xfascula, 1 n\xfamero y 1 caracter especial":""}get repeatPasswordErrorMessage(){return this.hasError("repeatPassword","required")?"Por favor, confirma tu contrase\xf1a":this.form.controls.repeatPassword.touched&&this.form.value.password!==this.form.value.repeatPassword?"Las contrase\xf1as no coinciden":""}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(s.qu),e.Y36(d.X_),e.Y36(b.B),e.Y36(x.K),e.Y36(w.e))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-profile"]],decls:66,vars:20,consts:[[1,"text-white","font-inter","text-3xl","font-bold"],[1,"text-white","font-inter","text-lg","font-semibold","my-8"],[1,"md:flex","md:flex-row","min-w-full","h-5/6","rounded-md"],[1,"md:w-1/2","my-4","mx-4","h-80","rounded-md","bg-white","overflow-x-auto","shadow-lg"],[1,"h-2/5","flex","flex-col","justify-end","items-start","ps-8",2,"background-image","url('assets/img/bg-pixeles.png')","background-size","cover"],["id","miImagen","title","Click aqui para cambiar la imagen.",1,"w-28","h-28","rounded-full","bg-white","flex","justify-center","items-center","cursor-pointer"],["id","preview","alt","imagen-perfil",1,"w-28","h-28","rounded-full","bg-white",3,"src"],["id","add",1,"material-symbols-outlined","text-8xl","text-white","absolute","rounded-full"],["type","file","id","img-picker","name","img-picker","accept",".png,.jpg.jpeg",1,"hidden",3,"change"],[1,"h-2/5","p-8"],["class"," font-inter text-3xl font-bold",4,"ngIf"],["class"," font-inter text-lg font-semibold my-4",4,"ngIf"],[1,"h-1/5","flex","justify-end","items-end","w-full"],["type","submit","color","success",1,"m-auto",3,"click"],[1,"md:w-1/2","my-4","mx-4","h-80","rounded-md","bg-white","overflow-x-auto","shadow-lg","flex","flex-col","justify-between"],[1,"h-4/5","p-8"],[1,"font-inter","text-3xl","font-bold"],["type","submit","color","success","class","m-auto",4,"ngIf"],["id","edit",1,"hidden"],[1,"my-4","mx-4","p-8","rounded-md","bg-white","overflow-x-auto","shadow-lg","flex","flex-col","justify-end"],[1,"flex","flex-col","gap-6",3,"formGroup","submit"],["for","name",1,"block","text-lg","text-gray-900"],["type","text","id","name","formControlName","nombre",1,"w-full","pt-0","px-3","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"value"],[1,"text-sm","font-semibold","text-red-700"],["for","lastName",1,"block","text-lg","text-gray-900"],["type","text","id","lastName","formControlName","apellido",1,"w-full","pt-0","px-3","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"value"],["for","email",1,"block","text-lg","text-gray-900"],["type","email","id","email","formControlName","email",1,"w-full","pt-0","px-3","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"value"],["for","password",1,"block","text-lg","text-gray-900"],[1,"relative"],["id","password","formControlName","password",1,"w-full","pt-0","pl-3","pr-10","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"type"],["type","button",1,"material-symbols-outlined","absolute","right-2","cursor-pointer",3,"click"],["for","repeatPassword",1,"block","text-lg","text-gray-900"],["id","repeatPassword","formControlName","repeatPassword",1,"w-full","pt-0","pl-3","pr-10","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"type"],["type","submit","color","success",1,"mt-8","m-auto"],[1,"font-inter","text-lg","font-semibold","my-4"],["class","text-green-600",4,"ngIf"],["class","text-blue-600",4,"ngIf"],[1,"text-green-600"],[1,"text-blue-600"],["type","submit","color","success",1,"m-auto"]],template:function(i,o){1&i&&(e.TgZ(0,"p",0),e._uU(1,"Perfil de usuario"),e.qZA(),e._UZ(2,"span",1),e.TgZ(3,"section",2)(4,"article",3)(5,"div",4)(6,"div",5),e._UZ(7,"img",6),e.TgZ(8,"span",7),e._uU(9,"add"),e.qZA(),e.TgZ(10,"input",8),e.NdJ("change",function(u){return o.uploadImage(u)}),e.qZA()()(),e.TgZ(11,"div",9),e.YNc(12,y,2,1,"h1",10),e.YNc(13,Z,2,1,"h2",11),e.qZA(),e.TgZ(14,"div",12)(15,"app-button",13),e.NdJ("click",function(){return o.showEdit()}),e._uU(16,"Editar perfil"),e.qZA()()(),e.TgZ(17,"article",14)(18,"div",15)(19,"h1",16),e._uU(20),e.qZA(),e.YNc(21,T,3,2,"h2",11),e.YNc(22,E,2,1,"h2",11),e.qZA(),e.TgZ(23,"div",12),e.YNc(24,_,2,0,"app-button",17),e.qZA()()(),e.TgZ(25,"section",18)(26,"article",19)(27,"form",20),e.NdJ("submit",function(){return o.onSubmit()}),e.TgZ(28,"div")(29,"label",21),e._uU(30,"Nombre"),e.qZA(),e._UZ(31,"input",22),e.TgZ(32,"strong",23),e._uU(33),e.qZA()(),e.TgZ(34,"div")(35,"label",24),e._uU(36,"Apellido"),e.qZA(),e._UZ(37,"input",25),e.TgZ(38,"strong",23),e._uU(39),e.qZA()(),e.TgZ(40,"div")(41,"label",26),e._uU(42,"E-mail"),e.qZA(),e._UZ(43,"input",27),e.TgZ(44,"strong",23),e._uU(45),e.qZA()(),e.TgZ(46,"div")(47,"label",28),e._uU(48,"Contrase\xf1a"),e.qZA(),e.TgZ(49,"div",29),e._UZ(50,"input",30),e.TgZ(51,"button",31),e.NdJ("click",function(){return o.handleShowPassword()}),e._uU(52),e.qZA()(),e.TgZ(53,"strong",23),e._uU(54),e.qZA()(),e.TgZ(55,"div")(56,"label",32),e._uU(57,"Confirmaci\xf3n de contrase\xf1a"),e.qZA(),e.TgZ(58,"div",29),e._UZ(59,"input",33),e.TgZ(60,"button",31),e.NdJ("click",function(){return o.handleShowRepeatPassword()}),e._uU(61),e.qZA()(),e.TgZ(62,"strong",23),e._uU(63),e.qZA()(),e.TgZ(64,"app-button",34),e._uU(65,"Guardar cambios"),e.qZA()()()()),2&i&&(e.xp6(7),e.s9C("src",o.UserResponse.imgUrl,e.LSH),e.xp6(5),e.Q6J("ngIf",o.UserResponse),e.xp6(1),e.Q6J("ngIf",o.UserResponse),e.xp6(7),e.Oqu("Acerca de"),e.xp6(1),e.Q6J("ngIf",o.UserResponse),e.xp6(1),e.Q6J("ngIf",o.UserResponse),e.xp6(2),e.Q6J("ngIf",!o.UserResponse.validEmail),e.xp6(3),e.Q6J("formGroup",o.form),e.xp6(4),e.s9C("value",o.UserResponse.nombre),e.xp6(2),e.Oqu(o.nameErrorMessage),e.xp6(4),e.s9C("value",o.UserResponse.apellido),e.xp6(2),e.Oqu(o.lastNameErrorMessage),e.xp6(4),e.s9C("value",o.UserResponse.email),e.xp6(2),e.Oqu(o.emailErrorMessage),e.xp6(5),e.Q6J("type",o.showPassword?"text":"password"),e.xp6(2),e.hij(" ",o.showPassword?"visibility":"visibility_off"," "),e.xp6(2),e.Oqu(o.passwordErrorMessage),e.xp6(5),e.Q6J("type",o.showRepeatPassword?"text":"password"),e.xp6(2),e.hij(" ",o.showRepeatPassword?"visibility":"visibility_off"," "),e.xp6(2),e.Oqu(o.repeatPasswordErrorMessage))},dependencies:[f.O5,v.r,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding-block:1rem;height:100%;background:url(/assets/img/stripe_dashboard.svg);background-repeat:no-repeat;background-size:contain cover;background-position:top right;padding-inline:1rem}@media screen and (min-width: 768px){[_nghost-%COMP%]{background-size:contain}}#add[_ngcontent-%COMP%]{opacity:0}#add[_ngcontent-%COMP%]:hover{opacity:1;background-color:#00000080;visibility:visible}"]})}return r})()}];let I=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275mod=e.oAB({type:r});static#r=this.\u0275inj=e.cJS({imports:[g.Bz.forChild(q),g.Bz]})}return r})();var k=n(8524);let A=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275mod=e.oAB({type:r});static#r=this.\u0275inj=e.cJS({imports:[f.ez,I,k.m,s.UX]})}return r})()}}]);