"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[153],{153:(b,c,r)=>{r.r(c),r.d(c,{PrincipalModule:()=>P});var h=r(6814),p=r(8589),l=r(9850),e=r(6689),u=r(4693),m=r(304),d=r(9781);const f=["mapContainer"];let g=(()=>{class n{constructor(t){this.mapService=t,this.greenPoints=[],this.filters="",this.markers=[]}ngAfterViewInit(){this.mapService.createMap(this.mapContainer.nativeElement).then(t=>{this.map=t,this.greenPoints.forEach(s=>this.addMarkerToMap(s)),this.addCurrentPositionToMap()})}ngOnChanges(t){t.greenPoints&&this.map&&this.greenPoints.forEach(s=>this.addMarkerToMap(s)),t.filters&&this.filterMarkers(this.filters)}addMarkerToMap(t){const i=parseFloat(t.latitud),o=parseFloat(t.longitud),k=this.mapService.createIcon("assets/img/custom-pinmap.svg"),a=this.mapService.createMarker([i,o],k),T=this.mapService.createContent(t);a.addTo(this.map).bindPopup(T).on("click",()=>a.openPopup()),this.markers.push(a)}addCurrentPositionToMap(){this.mapService.getCurrentPosition().then(t=>{const s=this.mapService.createIcon("assets/img/human-male.svg");this.mapService.createMarker(t,s).addTo(this.map).bindPopup("Tu estas aqu\xed.")}).catch(()=>{console.log("no se pudo obtener la posicion")})}filterMarkers(t){this.cleanMarkers(),"todos"!==t?this.greenPoints.filter(i=>i.materialesAceptados.includes(t)).forEach(i=>this.addMarkerToMap(i)):this.greenPoints.forEach(i=>this.addMarkerToMap(i))}cleanMarkers(){this.markers.forEach(t=>{t.remove()}),this.markers=[]}static#t=this.\u0275fac=function(s){return new(s||n)(e.Y36(d.S))};static#e=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-customMap"]],viewQuery:function(s,i){if(1&s&&e.Gf(f,5),2&s){let o;e.iGM(o=e.CRH())&&(i.mapContainer=o.first)}},inputs:{greenPoints:"greenPoints",filters:"filters"},features:[e.TTD],decls:2,vars:0,consts:[[1,"map","w-full","h-full","bg-slate-300"],["mapContainer",""]],template:function(s,i){1&s&&e._UZ(0,"div",0,1)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"]})}return n})();const v=[{path:"",component:(()=>{class n{constructor(t,s,i){this.greenpoint=t,this.authService=s,this.appData=i,this.greenpoints=[],this.filter="todos",this.filters=[],this.user=null}ngOnInit(){this.getGreenpoints(),this.authService.userLogged$.subscribe(t=>this.user=t),this.filters=this.appData.recicledTypes}getGreenpoints(){this.greenpoint.getAllGreenpoints().subscribe({next:t=>{console.log("get greenpoints",t),this.greenpoints=t},error:t=>console.error("ocurrio un error",{err:t})})}static#t=this.\u0275fac=function(s){return new(s||n)(e.Y36(u.N),e.Y36(m.e),e.Y36(l.X))};static#e=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-principal"]],features:[e._Bn([l.X])],decls:9,vars:4,consts:[[1,"text-white","text-xl","font-bold","md:text-2xl","mb-2"],[1,"text-white"],[1,"appointment","text-end","mb-2"],[1,"filters","mb-2"],[1,"text-white","mr-2"],[3,"greenPoints","filters"]],template:function(s,i){1&s&&(e.TgZ(0,"h2",0),e._uU(1),e.qZA(),e.TgZ(2,"p",1),e._uU(3," Aqu\xed encontraras los puntos de recepci\xf3n de desechos reciclables mas cerca de tu casa. "),e.qZA(),e._UZ(4,"div",2),e.TgZ(5,"div",3)(6,"span",4),e._uU(7,"Tipo de reciclaje:"),e.qZA()(),e._UZ(8,"app-customMap",5)),2&s&&(e.xp6(1),e.AsE(" Bienvenido ",null==i.user?null:i.user.nombre," ",null==i.user?null:i.user.apellido,".\n"),e.xp6(7),e.Q6J("greenPoints",i.greenpoints)("filters",i.filter))},dependencies:[g],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding-block:1rem;height:100%;background:url(/assets/img/stripe_dashboard.svg);background-repeat:no-repeat;background-size:contain cover;background-position:top right;padding-inline:1rem}@media screen and (min-width: 768px){[_nghost-%COMP%]{background-size:contain}}"]})}return n})()}];let M=(()=>{class n{static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275mod=e.oAB({type:n});static#s=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(v),p.Bz]})}return n})();var C=r(95);let P=(()=>{class n{static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275mod=e.oAB({type:n});static#s=this.\u0275inj=e.cJS({imports:[h.ez,M,C.u5]})}return n})()}}]);