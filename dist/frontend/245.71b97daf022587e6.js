"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[245],{245:(A,h,o)=>{o.r(h),o.d(h,{PrincipalModule:()=>x});var c=o(6814),u=o(9310),t=o(6689),d=o(4693),m=o(553),g=o(9862);let f=(()=>{class i{constructor(e){this.http=e,this.URL=m.N.apiUrl+"/api/usuario"}getUser(e){return this.http.get(this.URL+`/${e}`)}static#t=this.\u0275fac=function(n){return new(n||i)(t.LFG(g.eN))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var v=o(9626),r=o(95),M=o(9781);const C=["mapContainer"];let P=(()=>{class i{constructor(e){this.mapService=e,this.greenPoints=[],this.filters="",this.markers=[]}ngAfterViewInit(){this.mapService.createMap(this.mapContainer.nativeElement).then(e=>{this.map=e,this.greenPoints.forEach(n=>this.addMarkerToMap(n)),this.addCurrentPositionRadiusToMap()})}ngOnChanges(e){e.greenPoints&&this.map&&this.greenPoints.forEach(n=>this.addMarkerToMap(n)),e.filters&&this.filterMarkers(this.filters)}addMarkerToMap(e){const s=parseFloat(e.latitud),a=parseFloat(e.longitud),l=this.mapService.createIcon("assets/img/custom-pinmap.svg"),p=this.mapService.createMarker([s,a],l),U=this.mapService.createContent(e);p.addTo(this.map).bindPopup(U).on("click",()=>p.openPopup()),this.markers.push(p)}addCurrentPositionRadiusToMap(){this.mapService.getCurrentPosition().then(e=>{this.mapService.createCircle(e,1e3).addTo(this.map).bindPopup("Tu estas aqu\xed.")}).catch(()=>{console.log("no se pudo obtener la posicion")})}filterMarkers(e){this.cleanMarkers(),"todos"!==e?this.greenPoints.filter(s=>s.materialesAceptados.includes(e)).forEach(s=>this.addMarkerToMap(s)):this.greenPoints.forEach(s=>this.addMarkerToMap(s))}cleanMarkers(){this.markers.forEach(e=>{e.remove()}),this.markers=[]}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(M.S))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-customMap"]],viewQuery:function(n,s){if(1&n&&t.Gf(C,5),2&n){let a;t.iGM(a=t.CRH())&&(s.mapContainer=a.first)}},inputs:{greenPoints:"greenPoints",filters:"filters"},features:[t.TTD],decls:2,vars:0,consts:[[1,"map","w-full","h-full","bg-slate-300"],["mapContainer",""]],template:function(n,s){1&n&&t._UZ(0,"div",0,1)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"]})}return i})();function T(i,y){if(1&i&&(t.TgZ(0,"h2",12),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" Bienvenido ",t.lcZ(2,1,e.userData.nombre),".\n")}}const k=[{path:"",component:(()=>{class i{constructor(e,n,s){this.greenpoint=e,this.userService=n,this.tokenService=s,this.greenpoints=[],this.filter="todos"}ngOnInit(){this.getGreenpoints(),this.getUserData()}getGreenpoints(){this.greenpoint.getAllGreenpoints().subscribe({next:e=>{console.log("get greenpoints",e),this.greenpoints=e},error:e=>console.error("ocurrio un error",{err:e})})}getUserData(){const e=this.tokenService.getTokenDecoded();this.userService.getUser(e.USER_ID).subscribe({next:n=>{this.userData=n},error:n=>console.log("error al obtener user",n)})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(d.N),t.Y36(f),t.Y36(v.B))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-principal"]],decls:19,vars:4,consts:[["class","text-white text-xl font-bold md:text-2xl mb-2",4,"ngIf"],[1,"text-white"],[1,"appointment","text-end","mb-2"],[1,"filters","mb-2"],[1,"text-white","mr-2"],[1,"outline-none",3,"ngModel","ngModelChange"],["value","todos"],["value","METAL"],["value","PLASTICO"],["value","VIDRIO"],["value","PAPELCARTON"],[3,"greenPoints","filters"],[1,"text-white","text-xl","font-bold","md:text-2xl","mb-2"]],template:function(n,s){1&n&&(t.YNc(0,T,3,3,"h2",0),t.TgZ(1,"p",1),t._uU(2," Aqu\xed encontraras los puntos de recepci\xf3n de desechos reciclables mas cerca de tu casa.\n"),t.qZA(),t._UZ(3,"div",2),t.TgZ(4,"div",3)(5,"span",4),t._uU(6,"Tipo de reciclaje:"),t.qZA(),t.TgZ(7,"select",5),t.NdJ("ngModelChange",function(l){return s.filter=l}),t.TgZ(8,"option",6),t._uU(9,"Todos"),t.qZA(),t.TgZ(10,"option",7),t._uU(11,"Metal"),t.qZA(),t.TgZ(12,"option",8),t._uU(13,"Pl\xe1stico"),t.qZA(),t.TgZ(14,"option",9),t._uU(15,"Vidrio"),t.qZA(),t.TgZ(16,"option",10),t._uU(17,"Papel y carton"),t.qZA()()(),t._UZ(18,"app-customMap",11)),2&n&&(t.Q6J("ngIf",s.userData),t.xp6(7),t.Q6J("ngModel",s.filter),t.xp6(11),t.Q6J("greenPoints",s.greenpoints)("filters",s.filter))},dependencies:[c.O5,r.YN,r.Kr,r.EJ,r.JJ,r.On,P,c.rS],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding-block:1rem;height:100%;background:url(/assets/img/stripe_dashboard.svg);background-repeat:no-repeat;background-size:contain cover;background-position:top right;padding-inline:1rem}@media screen and (min-width: 768px){[_nghost-%COMP%]{background-size:contain}}"]})}return i})()}];let Z=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(k),u.Bz]})}return i})(),x=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[c.ez,Z,r.u5]})}return i})()}}]);