"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[128],{4128:(N,p,n)=>{n.r(p),n.d(p,{ProfileModule:()=>R});var m=n(6814),h=n(8589),s=n(95),d=n(9189),b=n(3519),f=n.n(b),e=n(6689),x=n(9626),g=n(553),w=n(9862);let v=(()=>{class r{constructor(t){this.http=t,this.UrlUser=g.N.apiUrl+"/api/usuario",this.UrlImage=g.N.apiUrl+"/img"}getUser(t){return this.http.get(this.UrlUser+`/${t}`)}updateUser(t,i){return this.http.put(this.UrlUser+`/${t}`,i)}PostImageUser(t){return this.http.post(this.UrlImage,t)}static#e=this.\u0275fac=function(i){return new(i||r)(e.LFG(w.eN))};static#t=this.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var y=n(304),U=n(2213);function Z(r,l){if(1&r&&(e.TgZ(0,"h1",15),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.UserResponse.nombre+" "+t.UserResponse.apellido," ")}}function P(r,l){if(1&r&&(e.TgZ(0,"h2",34),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.UserResponse.email)}}function E(r,l){1&r&&(e.TgZ(0,"p",37),e._uU(1,"Cuenta verificada"),e.qZA())}function I(r,l){1&r&&(e.TgZ(0,"p",38),e._uU(1,"Debe Verificar su cuenta"),e.qZA())}function T(r,l){if(1&r&&(e.TgZ(0,"h2",34),e.YNc(1,E,2,0,"p",35),e.YNc(2,I,2,0,"p",36),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.UserResponse.validEmail),e.xp6(1),e.Q6J("ngIf",!t.UserResponse.validEmail)}}function q(r,l){if(1&r&&(e.TgZ(0,"h2",34),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.UserResponse.puntos+" EcoPuntos")}}function k(r,l){1&r&&(e.TgZ(0,"app-button",39),e._uU(1,"Verificar cuenta"),e.qZA())}const A=[{path:"",component:(()=>{class r{constructor(t,i,o,a,u){this.fb=t,this.validator=i,this.tokenService=o,this.userService=a,this.authService=u,this.UserResponse=null,this.showPassword=!1,this.showRepeatPassword=!1,this.selectedImage=null,this.imageUrl=null,this.form=this.fb.group({nombre:["",[s.kI.required,s.kI.minLength(2),s.kI.maxLength(60),d.AE]],apellido:["",[s.kI.required,s.kI.minLength(2),s.kI.maxLength(60),d.AE]],email:["",[s.kI.required,s.kI.minLength(8),s.kI.maxLength(255),d.Le]],password:["",[s.kI.required,s.kI.minLength(8),s.kI.maxLength(128),d.ym]],repeatPassword:["",s.kI.required]})}ngOnInit(){this.authService.userLogged$.subscribe(t=>this.UserResponse=t),this.updateImage()}updateImage(){const t=document.querySelector("#img-picker"),i=document.querySelector("#preview"),o=document.querySelector("#miImagen").addEventListener("click",function(){console.log("Clicando"),t.click()});console.log(o),t.addEventListener("change",function a(){console.log("update image");const u=t.files[0],c=new FileReader;c.onload=function(){i.setAttribute("src",c.result)},u&&c.readAsDataURL(u)})}showEdit(){var t=document.getElementById("edit");t?.classList.toggle("hidden")}uploadImage(t){const i=t.target.files[0];if(i){const o=new FormData;o.append("imagen",i),this.userService.PostImageUser(o).subscribe({next:a=>console.log(a),error(a){console.log("error con la imagen",a)}})}}onSubmit(){if(this.form.invalid||this.form.value.password!==this.form.value.repeatPassword)return this.form.markAllAsTouched();this.userService.updateUser(this.UserResponse.userId,this.form.value).subscribe({next:()=>{console.log(this.selectedImage),f().fire({title:"\xa1Datos guardados exitosamente!",text:"Tus datos han sido actualizado",icon:"success"}).then(()=>{window.location.reload()})},error:t=>{console.log(t),f().fire({title:"Ha ocurrido un error...",text:t.error,icon:"error"})}})}onFileSelected(t){this.selectedImage=t.target.files[0]}handleShowPassword(){this.showPassword=!this.showPassword}handleShowRepeatPassword(){this.showRepeatPassword=!this.showRepeatPassword}hasError(t,i){return this.validator.hasError(this.form,t,i)}get nameErrorMessage(){const t="nombre";return this.hasError(t,"required")?"El nombre es requerido":this.hasError(t,"minlength")||this.hasError(t,"maxlength")?"Debe tener entre 2 y 60 caracteres":this.hasError(t,"numericSpecialCharacter")?"No se admiten caracteres num\xe9ricos ni especiales":""}get lastNameErrorMessage(){const t="apellido";return this.hasError(t,"required")?"El apellido es requerido":this.hasError(t,"numericSpecialCharacter")?"No se admiten caracteres num\xe9ricos ni especiales":this.hasError(t,"minlength")||this.hasError(t,"maxlength")?"Debe tener entre 2 y 60 caracteres":""}get emailErrorMessage(){return this.hasError("email","required")?"El email es requerido":this.hasError("email","email")?"Ingresa un email v\xe1lido":this.hasError("email","minlength")||this.hasError("email","maxlength")?"Debe tener entre 8 y 255 caracteres":""}get passwordErrorMessage(){return this.hasError("password","required")?"La contrase\xf1a es requerida":this.hasError("password","minlength")||this.hasError("password","maxlength")?"Debe tener entre 8 y 128 caracteres":this.hasError("password","password")?"Debe contener al menos 1 min\xfascula, 1 may\xfascula, 1 n\xfamero y 1 caracter especial":""}get repeatPasswordErrorMessage(){return this.hasError("repeatPassword","required")?"Por favor, confirma tu contrase\xf1a":this.form.controls.repeatPassword.touched&&this.form.value.password!==this.form.value.repeatPassword?"Las contrase\xf1as no coinciden":""}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(s.qu),e.Y36(d.X_),e.Y36(x.B),e.Y36(v),e.Y36(y.e))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-profile"]],decls:64,vars:20,consts:[[1,"text-white","font-inter","text-3xl","font-bold"],[1,"text-white","font-inter","text-lg","font-semibold","my-8"],[1,"md:flex","md:flex-row","min-w-full","h-5/6","rounded-md"],[1,"md:w-1/2","my-4","mx-4","h-80","rounded-md","bg-white","overflow-x-auto","shadow-lg"],[1,"h-2/5","flex","flex-col","justify-end","items-start","ps-8",2,"background-image","url('assets/img/bg-pixeles.png')","background-size","cover"],["id","miImagen",1,"w-28","h-28","rounded-full","bg-white","flex","justify-center","items-center"],["id","preview","alt","imagen-perfil",1,"w-28","h-28","rounded-full","bg-white",3,"src"],["type","file","id","img-picker","name","img-picker","accept",".png,.jpg.jpeg",1,"hidden",3,"change"],[1,"h-2/5","p-8"],["class"," font-inter text-3xl font-bold",4,"ngIf"],["class"," font-inter text-lg font-semibold my-4",4,"ngIf"],[1,"h-1/5","flex","justify-end","items-end","w-full"],["type","submit","color","success",1,"m-auto",3,"click"],[1,"md:w-1/2","my-4","mx-4","h-80","rounded-md","bg-white","overflow-x-auto","shadow-lg","flex","flex-col","justify-between"],[1,"h-4/5","p-8"],[1,"font-inter","text-3xl","font-bold"],["type","submit","color","success","class","m-auto",4,"ngIf"],["id","edit",1,"hidden"],[1,"my-4","mx-4","p-8","rounded-md","bg-white","overflow-x-auto","shadow-lg","flex","flex-col","justify-end"],[1,"flex","flex-col","gap-6",3,"formGroup","submit"],["for","name",1,"block","text-lg","text-gray-900"],["type","text","id","name","formControlName","nombre",1,"w-full","pt-0","px-3","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"value"],[1,"text-sm","font-semibold","text-red-700"],["for","lastName",1,"block","text-lg","text-gray-900"],["type","text","id","lastName","formControlName","apellido",1,"w-full","pt-0","px-3","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"value"],["for","email",1,"block","text-lg","text-gray-900"],["type","email","id","email","formControlName","email",1,"w-full","pt-0","px-3","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"value"],["for","password",1,"block","text-lg","text-gray-900"],[1,"relative"],["id","password","formControlName","password",1,"w-full","pt-0","pl-3","pr-10","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"type"],["type","button",1,"material-symbols-outlined","absolute","right-2","cursor-pointer",3,"click"],["for","repeatPassword",1,"block","text-lg","text-gray-900"],["id","repeatPassword","formControlName","repeatPassword",1,"w-full","pt-0","pl-3","pr-10","pb-1","text-gray-800","outline-none","border-b-2","border-gray-400","focus:border-sky-500",3,"type"],["type","submit","color","success",1,"mt-8","m-auto"],[1,"font-inter","text-lg","font-semibold","my-4"],["class","text-green-600",4,"ngIf"],["class","text-blue-600",4,"ngIf"],[1,"text-green-600"],[1,"text-blue-600"],["type","submit","color","success",1,"m-auto"]],template:function(i,o){1&i&&(e.TgZ(0,"p",0),e._uU(1,"Perfil de usuario"),e.qZA(),e._UZ(2,"span",1),e.TgZ(3,"section",2)(4,"article",3)(5,"div",4)(6,"div",5),e._UZ(7,"img",6),e.TgZ(8,"input",7),e.NdJ("change",function(u){return o.uploadImage(u)}),e.qZA()()(),e.TgZ(9,"div",8),e.YNc(10,Z,2,1,"h1",9),e.YNc(11,P,2,1,"h2",10),e.qZA(),e.TgZ(12,"div",11)(13,"app-button",12),e.NdJ("click",function(){return o.showEdit()}),e._uU(14,"Editar perfil"),e.qZA()()(),e.TgZ(15,"article",13)(16,"div",14)(17,"h1",15),e._uU(18),e.qZA(),e.YNc(19,T,3,2,"h2",10),e.YNc(20,q,2,1,"h2",10),e.qZA(),e.TgZ(21,"div",11),e.YNc(22,k,2,0,"app-button",16),e.qZA()()(),e.TgZ(23,"section",17)(24,"article",18)(25,"form",19),e.NdJ("submit",function(){return o.onSubmit()}),e.TgZ(26,"div")(27,"label",20),e._uU(28,"Nombre"),e.qZA(),e._UZ(29,"input",21),e.TgZ(30,"strong",22),e._uU(31),e.qZA()(),e.TgZ(32,"div")(33,"label",23),e._uU(34,"Apellido"),e.qZA(),e._UZ(35,"input",24),e.TgZ(36,"strong",22),e._uU(37),e.qZA()(),e.TgZ(38,"div")(39,"label",25),e._uU(40,"E-mail"),e.qZA(),e._UZ(41,"input",26),e.TgZ(42,"strong",22),e._uU(43),e.qZA()(),e.TgZ(44,"div")(45,"label",27),e._uU(46,"Contrase\xf1a"),e.qZA(),e.TgZ(47,"div",28),e._UZ(48,"input",29),e.TgZ(49,"button",30),e.NdJ("click",function(){return o.handleShowPassword()}),e._uU(50),e.qZA()(),e.TgZ(51,"strong",22),e._uU(52),e.qZA()(),e.TgZ(53,"div")(54,"label",31),e._uU(55,"Confirmaci\xf3n de contrase\xf1a"),e.qZA(),e.TgZ(56,"div",28),e._UZ(57,"input",32),e.TgZ(58,"button",30),e.NdJ("click",function(){return o.handleShowRepeatPassword()}),e._uU(59),e.qZA()(),e.TgZ(60,"strong",22),e._uU(61),e.qZA()(),e.TgZ(62,"app-button",33),e._uU(63,"Guardar cambios"),e.qZA()()()()),2&i&&(e.xp6(7),e.s9C("src",o.UserResponse.imgUrl,e.LSH),e.xp6(3),e.Q6J("ngIf",o.UserResponse),e.xp6(1),e.Q6J("ngIf",o.UserResponse),e.xp6(7),e.Oqu("Acerca de"),e.xp6(1),e.Q6J("ngIf",o.UserResponse),e.xp6(1),e.Q6J("ngIf",o.UserResponse),e.xp6(2),e.Q6J("ngIf",!o.UserResponse.validEmail),e.xp6(3),e.Q6J("formGroup",o.form),e.xp6(4),e.s9C("value",o.UserResponse.nombre),e.xp6(2),e.Oqu(o.nameErrorMessage),e.xp6(4),e.s9C("value",o.UserResponse.apellido),e.xp6(2),e.Oqu(o.lastNameErrorMessage),e.xp6(4),e.s9C("value",o.UserResponse.email),e.xp6(2),e.Oqu(o.emailErrorMessage),e.xp6(5),e.Q6J("type",o.showPassword?"text":"password"),e.xp6(2),e.hij(" ",o.showPassword?"visibility":"visibility_off"," "),e.xp6(2),e.Oqu(o.passwordErrorMessage),e.xp6(5),e.Q6J("type",o.showRepeatPassword?"text":"password"),e.xp6(2),e.hij(" ",o.showRepeatPassword?"visibility":"visibility_off"," "),e.xp6(2),e.Oqu(o.repeatPasswordErrorMessage))},dependencies:[m.O5,U.r,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding-block:1rem;height:100%;background:url(/assets/img/stripe_dashboard.svg);background-repeat:no-repeat;background-size:contain cover;background-position:top right;padding-inline:1rem}@media screen and (min-width: 768px){[_nghost-%COMP%]{background-size:contain}}"]})}return r})()}];let _=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275mod=e.oAB({type:r});static#r=this.\u0275inj=e.cJS({imports:[h.Bz.forChild(A),h.Bz]})}return r})();var C=n(8524);let R=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275mod=e.oAB({type:r});static#r=this.\u0275inj=e.cJS({imports:[m.ez,_,C.m,s.UX]})}return r})()}}]);