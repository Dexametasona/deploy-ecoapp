"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[153],{153:(A,p,o)=>{o.r(p),o.d(p,{PrincipalModule:()=>y});var u=o(6814),h=o(8589),m=o(9850),t=o(6689),d=o(4693),g=o(304),r=o(95),f=o(9781);const v=["mapContainer"];let M=(()=>{class s{constructor(e){this.mapService=e,this.greenPoints=[],this.filters="",this.markers=[]}ngAfterViewInit(){this.mapService.createMap(this.mapContainer.nativeElement).then(e=>{this.map=e,this.greenPoints.forEach(n=>this.addMarkerToMap(n)),this.addCurrentPositionToMap()})}ngOnChanges(e){e.greenPoints&&this.map&&this.greenPoints.forEach(n=>this.addMarkerToMap(n)),e.filters&&this.filterMarkers(this.filters)}addMarkerToMap(e){const i=parseFloat(e.latitud),a=parseFloat(e.longitud),c=this.mapService.createIcon("assets/img/custom-pinmap.svg"),l=this.mapService.createMarker([i,a],c),b=this.mapService.createContent(e);l.addTo(this.map).bindPopup(b).on("click",()=>l.openPopup()),this.markers.push(l)}addCurrentPositionToMap(){this.mapService.getCurrentPosition().then(e=>{const n=this.mapService.createIcon("assets/img/human-male.svg");this.mapService.createMarker(e,n).addTo(this.map).bindPopup("Tu estas aqu\xed.")}).catch(()=>{console.log("no se pudo obtener la posicion")})}filterMarkers(e){this.cleanMarkers(),"todos"!==e?this.greenPoints.filter(i=>i.materialesAceptados.includes(e)).forEach(i=>this.addMarkerToMap(i)):this.greenPoints.forEach(i=>this.addMarkerToMap(i))}cleanMarkers(){this.markers.forEach(e=>{e.remove()}),this.markers=[]}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(f.S))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-customMap"]],viewQuery:function(n,i){if(1&n&&t.Gf(v,5),2&n){let a;t.iGM(a=t.CRH())&&(i.mapContainer=a.first)}},inputs:{greenPoints:"greenPoints",filters:"filters"},features:[t.TTD],decls:2,vars:0,consts:[[1,"map","w-full","h-full","bg-slate-300"],["mapContainer",""]],template:function(n,i){1&n&&t._UZ(0,"div",0,1)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"]})}return s})();var C=o(5152);function P(s,Z){if(1&s&&(t.TgZ(0,"option",9),t._uU(1),t.ALo(2,"typeFormat"),t.qZA()),2&s){const e=Z.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(t.lcZ(2,2,e))}}const T=[{path:"",component:(()=>{class s{constructor(e,n,i){this.greenpoint=e,this.authService=n,this.appData=i,this.greenpoints=[],this.filter="todos",this.filters=[],this.user=null}ngOnInit(){this.getGreenpoints(),this.authService.userLogged$.subscribe(e=>this.user=e),this.filters=this.appData.recicledTypes}getGreenpoints(){this.greenpoint.getAllGreenpoints().subscribe({next:e=>{console.log("get greenpoints",e),this.greenpoints=e},error:e=>console.error("ocurrio un error",{err:e})})}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(d.N),t.Y36(g.e),t.Y36(m.X))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-principal"]],features:[t._Bn([m.X])],decls:13,vars:6,consts:[[1,"text-white","text-xl","font-bold","md:text-2xl","mb-2"],[1,"text-white"],[1,"appointment","text-end","mb-2"],[1,"filters","mb-2"],[1,"text-white","mr-2"],[1,"outline-none",3,"ngModel","ngModelChange"],["value","todos"],[3,"value",4,"ngFor","ngForOf"],[3,"greenPoints","filters"],[3,"value"]],template:function(n,i){1&n&&(t.TgZ(0,"h2",0),t._uU(1),t.qZA(),t.TgZ(2,"p",1),t._uU(3," Aqu\xed encontrar\xe1s los puntos de recepci\xf3n de materiales reciclables m\xe1s cerca de tu casa.\n"),t.qZA(),t._UZ(4,"div",2),t.TgZ(5,"div",3)(6,"span",4),t._uU(7,"Tipo de reciclaje:"),t.qZA(),t.TgZ(8,"select",5),t.NdJ("ngModelChange",function(c){return i.filter=c}),t.TgZ(9,"option",6),t._uU(10,"Todos"),t.qZA(),t.YNc(11,P,3,4,"option",7),t.qZA()(),t._UZ(12,"app-customMap",8)),2&n&&(t.xp6(1),t.AsE(" Bienvenid@ ",null==i.user?null:i.user.nombre," ",null==i.user?null:i.user.apellido,".\n"),t.xp6(7),t.Q6J("ngModel",i.filter),t.xp6(3),t.Q6J("ngForOf",i.filters),t.xp6(1),t.Q6J("greenPoints",i.greenpoints)("filters",i.filter))},dependencies:[u.sg,r.YN,r.Kr,r.EJ,r.JJ,r.On,M,C.Q],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding-block:1rem;height:100%;background:url(/assets/img/stripe_dashboard.svg);background-repeat:no-repeat;background-size:contain cover;background-position:top right;padding-inline:1rem}@media screen and (min-width: 768px){[_nghost-%COMP%]{background-size:contain}}"]})}return s})()}];let k=(()=>{class s{static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275mod=t.oAB({type:s});static#n=this.\u0275inj=t.cJS({imports:[h.Bz.forChild(T),h.Bz]})}return s})(),y=(()=>{class s{static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275mod=t.oAB({type:s});static#n=this.\u0275inj=t.cJS({imports:[u.ez,k,r.u5]})}return s})()}}]);