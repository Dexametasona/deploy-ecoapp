"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[153],{153:(k,p,o)=>{o.r(p),o.d(p,{PrincipalModule:()=>P});var h=o(6814),u=o(8589),e=o(6689),d=o(4693),m=o(304),r=o(95),g=o(9781);const f=["mapContainer"];let v=(()=>{class s{constructor(t){this.mapService=t,this.greenPoints=[],this.filters="",this.markers=[]}ngAfterViewInit(){this.mapService.createMap(this.mapContainer.nativeElement).then(t=>{this.map=t,this.greenPoints.forEach(n=>this.addMarkerToMap(n)),this.addCurrentPositionToMap()})}ngOnChanges(t){t.greenPoints&&this.map&&this.greenPoints.forEach(n=>this.addMarkerToMap(n)),t.filters&&this.filterMarkers(this.filters)}addMarkerToMap(t){const i=parseFloat(t.latitud),a=parseFloat(t.longitud),c=this.mapService.createIcon("assets/img/custom-pinmap.svg"),l=this.mapService.createMarker([i,a],c),T=this.mapService.createContent(t);l.addTo(this.map).bindPopup(T).on("click",()=>l.openPopup()),this.markers.push(l)}addCurrentPositionToMap(){this.mapService.getCurrentPosition().then(t=>{const n=this.mapService.createIcon("assets/img/human-male.svg");this.mapService.createMarker(t,n).addTo(this.map).bindPopup("Tu estas aqu\xed.")}).catch(()=>{console.log("no se pudo obtener la posicion")})}filterMarkers(t){this.cleanMarkers(),"todos"!==t?this.greenPoints.filter(i=>i.materialesAceptados.includes(t)).forEach(i=>this.addMarkerToMap(i)):this.greenPoints.forEach(i=>this.addMarkerToMap(i))}cleanMarkers(){this.markers.forEach(t=>{t.remove()}),this.markers=[]}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(g.S))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-customMap"]],viewQuery:function(n,i){if(1&n&&e.Gf(f,5),2&n){let a;e.iGM(a=e.CRH())&&(i.mapContainer=a.first)}},inputs:{greenPoints:"greenPoints",filters:"filters"},features:[e.TTD],decls:2,vars:0,consts:[[1,"map","w-full","h-full","bg-slate-300"],["mapContainer",""]],template:function(n,i){1&n&&e._UZ(0,"div",0,1)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"]})}return s})();const M=[{path:"",component:(()=>{class s{constructor(t,n){this.greenpoint=t,this.authService=n,this.greenpoints=[],this.filter="todos",this.user=null}ngOnInit(){this.getGreenpoints(),this.authService.userLogged$.subscribe(t=>this.user=t)}getGreenpoints(){this.greenpoint.getAllGreenpoints().subscribe({next:t=>{console.log("get greenpoints",t),this.greenpoints=t},error:t=>console.error("ocurrio un error",{err:t})})}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(d.N),e.Y36(m.e))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-principal"]],decls:20,vars:5,consts:[[1,"text-white","text-xl","font-bold","md:text-2xl","mb-2"],[1,"text-white"],[1,"appointment","text-end","mb-2"],[1,"filters","mb-2"],[1,"text-white","mr-2"],[1,"outline-none",3,"ngModel","ngModelChange"],["value","todos"],["value","METAL"],["value","PLASTICO"],["value","VIDRIO"],["value","PAPELCARTON"],[3,"greenPoints","filters"]],template:function(n,i){1&n&&(e.TgZ(0,"h2",0),e._uU(1),e.qZA(),e.TgZ(2,"p",1),e._uU(3," Aqu\xed encontraras los puntos de recepci\xf3n de desechos reciclables mas cerca de tu casa.\n"),e.qZA(),e._UZ(4,"div",2),e.TgZ(5,"div",3)(6,"span",4),e._uU(7,"Tipo de reciclaje:"),e.qZA(),e.TgZ(8,"select",5),e.NdJ("ngModelChange",function(c){return i.filter=c}),e.TgZ(9,"option",6),e._uU(10,"Todos"),e.qZA(),e.TgZ(11,"option",7),e._uU(12,"Metal"),e.qZA(),e.TgZ(13,"option",8),e._uU(14,"Pl\xe1stico"),e.qZA(),e.TgZ(15,"option",9),e._uU(16,"Vidrio"),e.qZA(),e.TgZ(17,"option",10),e._uU(18,"Papel y carton"),e.qZA()()(),e._UZ(19,"app-customMap",11)),2&n&&(e.xp6(1),e.AsE(" Bienvenido ",null==i.user?null:i.user.nombre," ",null==i.user?null:i.user.apellido,".\n"),e.xp6(7),e.Q6J("ngModel",i.filter),e.xp6(11),e.Q6J("greenPoints",i.greenpoints)("filters",i.filter))},dependencies:[r.YN,r.Kr,r.EJ,r.JJ,r.On,v],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding-block:1rem;height:100%;background:url(/assets/img/stripe_dashboard.svg);background-repeat:no-repeat;background-size:contain cover;background-position:top right;padding-inline:1rem}@media screen and (min-width: 768px){[_nghost-%COMP%]{background-size:contain}}"]})}return s})()}];let C=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[u.Bz.forChild(M),u.Bz]})}return s})(),P=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[h.ez,C,r.u5]})}return s})()}}]);